# Xray-Lite - Lightweight Xray Rust Implementation

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Rust](https://img.shields.io/badge/rust-1.70%2B-orange.svg)](https://www.rust-lang.org/)

A high-performance VLESS+Reality+XHTTP proxy server implemented in Rust, fully compatible with all Xray clients.

## âœ¨ Features

- ğŸš€ **High Performance**: Built on Tokio async runtime, fully utilizing multi-core performance
- ğŸ”’ **Reality Protocol**: Advanced traffic masquerading, resistant to active probing
- ğŸŒ **XHTTP Support**: HTTP/2 + gRPC masquerading, penetrates CDN
- ğŸª¶ **Lightweight**: Only 1.5MB binary, low memory footprint
- ğŸ”§ **Easy Deployment**: One-click deployment script, systemd service support
- âœ… **Xray Compatible**: 100% compatible with all Xray clients

## ğŸ”„ Xray Client Compatibility

**Fully compatible with the following clients**:
- âœ… Xray-core (Official client)
- âœ… v2rayN (Windows)
- âœ… v2rayNG (Android)
- âœ… Shadowrocket (iOS)
- âœ… All clients supporting VLESS+Reality

| Component | Compatibility |
|-----------|---------------|
| VLESS Protocol | âœ… 100% |
| Reality Authentication | âœ… 100% |
| XHTTP Transport | âœ… 100% |
| Config Format | âœ… 100% |
| Key Format | âœ… 100% |

## ğŸš€ Quick Start

### Method 1: One-Click Installation (Recommended)

Run the following command on your server (requires root):

```bash
curl -fsSL https://raw.githubusercontent.com/undead-undead/xray-lite/main/install.sh | bash
```

The script will automatically:
1. â¬‡ï¸ Download the latest binary from GitHub Release
2. ğŸ”‘ Generate keys and UUID
3. âš™ï¸ Configure systemd service
4. ğŸ”¥ Start the server
5. ğŸ“± Show client configuration

### Method 2: Build from Source

```bash
# Clone the project
git clone https://github.com/undead-undead/xray-lite.git
cd xray-lite

# Build and run
./deploy.sh
```

The script will verify your build environment and compile release binaries.

### Method 3: Manual Configuration

#### 1. Generate Key Pair

```bash
cargo run --bin keygen
```

Example output:
```
Private key: qM2cc_YkTi4G62CP2RBk5-m48Baxus5T7FM28ZRmpyQ
Public key:  xKvN8mL3pQ5rT7yU9wV1bC3dE5fG7hI9jK1lM3nO5pQ
```

#### 2. Create Configuration File

```bash
cargo run --bin genconfig > config.json
```

Edit `config.json`:
```json
{
  "inbounds": [{
    "protocol": "vless",
    "port": 443,
    "settings": {
      "clients": [{
        "id": "YOUR-UUID-HERE"
      }]
    },
    "streamSettings": {
      "security": "reality",
      "realitySettings": {
        "dest": "www.microsoft.com:443",
        "serverNames": ["www.microsoft.com"],
        "privateKey": "YOUR-PRIVATE-KEY-HERE",
        "shortIds": ["0123456789abcdef"]
      }
    }
  }]
}
```

#### 3. Build and Run

```bash
# Build
cargo build --release

# Run
./target/release/vless-server --config config.json
```

## ğŸ“¦ Install as System Service

```bash
# Build the project
cargo build --release

# Install service (requires root)
sudo ./install_service.sh
```

Service management:
```bash
sudo systemctl start xray-lite      # Start
sudo systemctl stop xray-lite       # Stop
sudo systemctl status xray-lite     # Status
sudo journalctl -u xray-lite -f     # Logs
```

## ğŸ”§ Tools

### keygen - Key Generation Tool

```bash
cargo run --bin keygen
```

Generates X25519 key pairs in Xray format (URL-safe Base64, no padding).

### genconfig - Configuration Generator

```bash
cargo run --bin genconfig
```

Generates configuration file template.

## ğŸ“± Client Configuration

### Xray Client

Use `client-config.json` generated by `deploy.sh`:

```bash
xray run -c client-config.json
```

### v2rayN (Windows)

1. Add server
2. Select VLESS protocol
3. Configure parameters:
   - Address: Your server IP
   - Port: 443
   - UUID: From config file
   - Transport: TCP
   - Security: Reality
   - Public Key: From keygen
   - ServerName: www.microsoft.com
   - Short ID: 0123456789abcdef

## ğŸ§ª Testing

### Basic Functionality Test

```bash
./test_reality_basic.sh
```

### Integration Test (requires Xray)

```bash
# Install Xray
bash -c "$(curl -L https://github.com/XTLS/Xray-install/raw/main/install-release.sh)" @ install

# Run test
./test_xray_integration.sh
```

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   VLESS Server                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Reality    â”‚  â”‚    XHTTP     â”‚  â”‚  Routing  â”‚ â”‚
â”‚  â”‚   (TLS 1.3)  â”‚  â”‚  (HTTP/2)    â”‚  â”‚           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         VLESS Protocol Handler               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Tokio Async Runtime                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Core Modules**:
- `config/` - Configuration management
- `protocol/vless/` - VLESS protocol implementation
- `transport/reality/` - Reality TLS handshake
- `transport/xhttp/` - XHTTP HTTP/2 + gRPC
- `network/` - Network connection management
- `utils/` - Utility functions

## ğŸ“Š Performance

- **Binary Size**: ~1.5MB (stripped)
- **Memory Usage**: ~10MB (idle)
- **Concurrent Connections**: Supports thousands
- **Latency**: Reality handshake ~100ms

## ğŸ› Troubleshooting

### Build Failure

```bash
rustup update
cargo clean
cargo build --release
```

### Connection Failure

Checklist:
1. âœ… Is the firewall port open?
2. âœ… Is the configuration correct?
3. âœ… Do the keys match?
4. âœ… Is the Short ID consistent?

View logs:
```bash
RUST_LOG=debug ./target/release/vless-server --config config.json
```

## ğŸ“š Documentation

- [DESIGN.md](DESIGN.md) - Architecture design documentation
- [USAGE.md](USAGE.md) - Detailed usage guide

## ğŸ”’ Security Recommendations

1. **Key Management**
   - Keep private keys secure
   - Rotate keys regularly
   - Don't share configurations publicly

2. **Firewall Configuration**
   ```bash
   ufw allow 443/tcp
   ufw enable
   ```

3. **Regular Updates**
   ```bash
   git pull
   cargo build --release
   sudo systemctl restart xray-lite
   ```

## ğŸ¤ Contributing

Issues and Pull Requests are welcome!

## ğŸ“„ License

MIT License - See [LICENSE](LICENSE) file for details

## ğŸ™ Acknowledgments

- [Xray-core](https://github.com/XTLS/Xray-core) - Reality protocol design
- [Tokio](https://tokio.rs/) - Async runtime
- [rustls](https://github.com/rustls/rustls) - TLS implementation

## â­ Star History

If this project helps you, please give it a Star!

---

**Note**: This project is for learning and research purposes only. Please comply with local laws and regulations.
